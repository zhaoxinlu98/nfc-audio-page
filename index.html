<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>æé€Ÿå°é±¼æ’­æ”¾å™¨ - å¸¦æ§åˆ¶æŒ‰é’®ä¸è‡ªå®šä¹‰è¿›åº¦æ¡</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-color: #D7EEF6;
      --card-color: #ffffff;
      --text-color: #1a1a1a;
      --accent-color: #18B7F6;
      --accent-hover: #139bd7;
      --progress-bg: #cbe9f9;
      --progress-fill: #18B7F6;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: background-color 0.4s, color 0.4s;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background-color: var(--card-color);
      padding: 1rem 1.5rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    header h1 {
      margin: 0;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      user-select: none;
    }

    .theme-toggle {
      background-color: var(--accent-color);
      color: white;
      border: none;
      padding: 0.4rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s;
      user-select: none;
    }

    .theme-toggle:hover {
      background-color: var(--accent-hover);
    }

    main {
      flex-grow: 1;
      max-width: 900px;
      margin: 1rem auto 2rem;
      width: 90%;
      padding-top: 170px; /* ç»™æ’­æ”¾çª—å£ç•™å‡ºç©ºé—´ */
    }

    /* æ’­æ”¾çª—å£ å›ºå®šä¸”æ˜æ˜¾ */
    .player {
      background-color: var(--card-color);
      border-radius: 12px;
      padding: 1rem 1.5rem;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      position: fixed;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-width: 900px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.6rem;
      z-index: 999;
      user-select: none;
    }

    .player .title {
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--accent-color);
      text-align: center;
      user-select: text;
    }

    /* è‡ªå®šä¹‰éŸ³é¢‘æ§ä»¶ */
    audio {
      width: 100%;
      outline: none;
      border-radius: 6px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      appearance: none;
      background: var(--progress-bg);
      height: 10px;
      cursor: pointer;
      margin: 0.5rem 0 0;
      -webkit-appearance: none;
    }
    audio::-webkit-media-controls-panel {
      display: none !important;
    }
    audio::-webkit-media-controls-play-button,
    audio::-webkit-media-controls-volume-slider {
      display: none !important;
    }

    /* è‡ªå®šä¹‰è¿›åº¦æ¡ */
    audio::-webkit-slider-runnable-track {
      height: 10px;
      background: var(--progress-bg);
      border-radius: 5px;
    }
    audio::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      background: var(--accent-color);
      border-radius: 50%;
      cursor: pointer;
      margin-top: -3px;
      box-shadow: 0 0 6px rgba(24,183,246,0.8);
      transition: background-color 0.3s;
    }
    audio::-webkit-slider-thumb:hover {
      background: var(--accent-hover);
    }

    /* æ¨¡å—Tabå¯¼èˆª */
    .modules-nav {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
      user-select: none;
    }

    .modules-nav button {
      background-color: var(--card-color);
      border: 2px solid var(--accent-color);
      color: var(--accent-color);
      font-weight: 600;
      padding: 0.5rem 1.2rem;
      border-radius: 30px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
      font-size: 1rem;
      min-width: 140px;
      white-space: nowrap;
    }

    .modules-nav button[aria-selected="true"],
    .modules-nav button:hover {
      background-color: var(--accent-color);
      color: white;
    }

    /* éŸ³é¢‘åˆ—è¡¨ */
    .audio-list {
      background-color: var(--card-color);
      border-radius: 12px;
      padding: 1rem 1.5rem;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      max-height: 350px;
      overflow-y: auto;
      outline: none;
    }

    .audio-item {
      padding: 0.8rem 1rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      background-color: #f4faff;
      cursor: pointer;
      font-weight: 600;
      color: var(--accent-color);
      transition: background-color 0.3s, color 0.3s;
      user-select: none;
    }

    /* é€‰ä¸­éŸ³é¢‘çš„é¢œè‰²æ”¹ä¸º #18B7F6 */
    .audio-item:hover,
    .audio-item.selected,
    .audio-item:focus-visible {
      background-color: #18B7F6;
      color: white;
      box-shadow: 0 2px 12px rgba(24, 183, 246, 0.6);
      outline: none;
    }

    /* æ’­æ”¾æ§åˆ¶æŒ‰é’®å®¹å™¨ */
    .controls {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-top: 0.3rem;
      user-select: none;
    }

    .controls button {
      background-color: var(--accent-color);
      border: none;
      color: white;
      padding: 0.4rem 1rem;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .controls button:hover {
      background-color: var(--accent-hover);
    }

    /* å“åº”å¼ */
    @media (max-width: 600px) {
      .modules-nav {
        flex-direction: column;
        gap: 0.8rem;
      }
      .modules-nav button {
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>ğŸŸ æé€Ÿå°é±¼</h1>
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="åˆ‡æ¢ä¸»é¢˜">åˆ‡æ¢ä¸»é¢˜</button>
  </header>

  <div class="player" role="region" aria-label="å½“å‰æ’­æ”¾éŸ³é¢‘">
    <div class="title" id="current-title" tabindex="0">è¯·é€‰æ‹©éŸ³é¢‘æ’­æ”¾</div>
    <audio id="audio-player" preload="metadata"></audio>
    <div class="controls">
      <button id="prev-btn" aria-label="ä¸Šä¸€é¦–">ä¸Šä¸€é¦–</button>
      <button id="play-pause-btn" aria-label="æ’­æ”¾/æš‚åœ">æ’­æ”¾</button>
      <button id="next-btn" aria-label="ä¸‹ä¸€é¦–">ä¸‹ä¸€é¦–</button>
      <button id="shuffle-btn" aria-pressed="false" aria-label="éšæœºæ’­æ”¾">éšæœºæ’­æ”¾</button>
    </div>
  </div>

  <main>
    <nav class="modules-nav" role="tablist" aria-label="éŸ³é¢‘æ¨¡å—åˆ‡æ¢">
      <button role="tab" aria-selected="true" tabindex="0" data-module="gululu" id="tab-gululu">ğŸ  å°é±¼å’•å™œ</button>
      <button role="tab" aria-selected="false" tabindex="-1" data-module="sing" id="tab-sing">ğŸ¤ å°é±¼å”±æ­Œ</button>
      <button role="tab" aria-selected="false" tabindex="-1" data-module="story" id="tab-story">ğŸ“– å°é±¼è®²æ•…äº‹</button>
    </nav>

    <section
      class="audio-list"
      id="audio-list"
      role="tabpanel"
      tabindex="0"
      aria-labelledby="tab-gululu"
      aria-live="polite"
    >
      <!-- åŠ¨æ€å†…å®¹ -->
    </section>
  </main>

<script>
  const modules = {
    gululu: [
      { title: 'ä¸è¦å®³æ€•å›°éš¾', src: 'buyaohaipaikunnan.mp3', type: 'audio/mpeg' },
      { title: 'å†¬æ—¥ç¥ç¦', src: 'dongrizhufu.mp3', type: 'audio/mpeg' },
      { title: 'å“¥ä¹Ÿå–œæ¬¢ä½ ', src: 'ge-ye-xihuan-ni.m4a', type: 'audio/mp4' },
      { title: 'å‚¬ä½ å…¥ç¡', src: 'cuini_rushui.mp3', type: 'audio/mpeg' },
      { title: 'æ¥ç”µè¯', src: 'jiedianhua.mp3', type: 'audio/mpeg' },
      { title: 'å§å§', src: 'jiejie.mp3', type: 'audio/mpeg' },
      { title: 'å¦¹å¦¹æ™šå®‰', src: 'meimei-wanan.m4a', type: 'audio/mp4' },
      { title: 'å¤ªé˜³æ™’å±è‚¡', src: 'taiyangshai_pigu.mp3', type: 'audio/mpeg' },
      { title: 'èµ·åºŠé—¹é“ƒï¼ˆç”Ÿæ—¥ç‰ˆï¼‰', src: 'qichuang_naoling_shengri.mp3', type: 'audio/mpeg' },
      { title: 'æ’’å¨‡å…«è¿', src: 'sajiaobalian.mp3', type: 'audio/mpeg' },
      { title: 'ç”Ÿæ—¥è¯»ä¿¡', src: 'shengri_duxin.mp3', type: 'audio/mpeg' },
      { title: 'æˆ‘ä»¬è¿˜ä¼šå†è§é¢çš„', src: 'women_haohui_zai_jian_men.mp3', type: 'audio/mpeg' },
      { title: 'å§å§æ—©ç‚¹ç¡è§‰å§', src: 'jiejie_zaodian_shuijiao_ba.mp3', type: 'audio/mpeg' },
      { title: 'æ–°çš„ä¸€å¹´å¸Œæœ›æ˜å¹´è¦æ¯”ä»Šå¹´æ›´å¼€å¿ƒä¸€ç‚¹', src: 'xin_de_yinian_xiwang.mp3', type: 'audio/mpeg' },
      { title: 'å†åšæŒä¸€ä¸‹æˆ‘çš„äººç”Ÿé«˜å…‰å°±æ¥äº†', src: 'zaijianchi_yixia_rensheng_gaoguang.mp3', type: 'audio/mpeg' },
      { title: 'å¦ˆå¦ˆæ™šå®‰', src: 'mama_wanan.mp3', type: 'audio/mpeg' }
    ],
    sing: [
      { title: 'è‚†æ„ç”ŸèŠ±ç‰‡æ®µï¼ˆç›´æ’­ç‰ˆï¼‰', src: 'siyishenghua_live.mp3', type: 'audio/mpeg' },
      { title: 'ç‰¹åˆ«çš„äºº', src: 'tebie_de_ren.mp3', type: 'audio/mpeg' },
      { title: 'è¤ªé»‘ç´ ', src: 'tuheisu.mp3', type: 'audio/mpeg' }
    ],
    story: [
      { title: 'å°ç¡çœ ', src: 'xiaoshuimian.mp3', type: 'audio/mpeg' },
      { title: 'å°é±¼æ¸¸åˆ°å¤§æµ·é‡Œäº†å—', src: 'xiaoyu_youdao_dahaili_le_ma.mp3', type: 'audio/mpeg' }
    ]
  };

  const audioListElem = document.getElementById('audio-list');
  const audioPlayer = document.getElementById('audio-player');
  const currentTitle = document.getElementById('current-title');
  const tabs = document.querySelectorAll('.modules-nav button');
  const prevBtn = document.getElementById('prev-btn');
  const playPauseBtn = document.getElementById('play-pause-btn');
  const nextBtn = document.getElementById('next-btn');
  const shuffleBtn = document.getElementById('shuffle-btn');

  let currentModule = 'gululu';
  let currentAudioIndex = null;
  let focusedAudioIndex = 0;
  let isShuffle = false;

  function switchModule(event) {
    const clickedTab = event.currentTarget;

    tabs.forEach(tab => {
      tab.setAttribute('aria-selected', 'false');
      tab.setAttribute('tabindex', '-1');
    });
    clickedTab.setAttribute('aria-selected', 'true');
    clickedTab.setAttribute('tabindex', '0');
    clickedTab.focus();

    currentModule = clickedTab.getAttribute('data-module');
    currentAudioIndex = null;
    focusedAudioIndex = 0;
    currentTitle.textContent = 'è¯·é€‰æ‹©éŸ³é¢‘æ’­æ”¾';
    audioPlayer.pause();
    audioPlayer.removeAttribute('src');
    audioPlayer.load();

    updateAriaControls();
    renderAudioList();
    updatePlayPauseButton();
  }

  function updateAriaControls() {
    tabs.forEach(tab => {
      const panelId = 'audio-list';
      tab.setAttribute('aria-controls', panelId);
    });
    audioListElem.setAttribute('aria-labelledby', [...tabs].find(t => t.getAttribute('aria-selected') === 'true').id);
  }

  function renderAudioList() {
    audioListElem.innerHTML = '';

    modules[currentModule].forEach((audio, index) => {
      const div = document.createElement('div');
      div.className = 'audio-item';
      div.textContent = audio.title;
      div.setAttribute('tabindex', '-1');
      div.setAttribute('role', 'button');
      div.setAttribute('aria-pressed', 'false');

      div.addEventListener('click', () => playAudio(index));
      div.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          playAudio(index);
        }
        if (e.key === 'ArrowDown') {
          e.preventDefault();
          focusAudio((index + 1) % modules[currentModule].length);
        }
        if (e.key === 'ArrowUp') {
          e.preventDefault();
          focusAudio((index - 1 + modules[currentModule].length) % modules[currentModule].length);
        }
      });

      if (index === currentAudioIndex) {
        div.classList.add('selected');
        div.setAttribute('aria-pressed', 'true');
      }

      audioListElem.appendChild(div);
    });

    focusAudio(focusedAudioIndex);
  }

  function playAudio(index) {
    const audio = modules[currentModule][index];
    if (!audio) return;
    audioPlayer.src = audio.src;
    audioPlayer.type = audio.type;
    audioPlayer.play();

    currentTitle.textContent = audio.title;
    currentAudioIndex = index;
    focusedAudioIndex = index;
    updateSelectedAudio();
    updatePlayPauseButton();
  }

  function updateSelectedAudio() {
    const items = audioListElem.querySelectorAll('.audio-item');
    items.forEach((item, i) => {
      if (i === currentAudioIndex) {
        item.classList.add('selected');
        item.setAttribute('aria-pressed', 'true');
      } else {
        item.classList.remove('selected');
        item.setAttribute('aria-pressed', 'false');
      }
    });
  }

  function focusAudio(index) {
    const items = audioListElem.querySelectorAll('.audio-item');
    if (items.length === 0) return;
    if (index < 0) index = items.length -1;
    if (index >= items.length) index = 0;

    items.forEach(item => item.setAttribute('tabindex', '-1'));
    items[index].setAttribute('tabindex', '0');
    items[index].focus();
    focusedAudioIndex = index;
  }

  function toggleTheme() {
    document.body.classList.toggle('dark-mode');
  }

  // éšæœºæ’­æ”¾å¼€å…³
  shuffleBtn.addEventListener('click', () => {
    isShuffle = !isShuffle;
    shuffleBtn.setAttribute('aria-pressed', isShuffle.toString());
    shuffleBtn.style.backgroundColor = isShuffle ? 'var(--accent-hover)' : 'var(--accent-color)';
  });

  // è·å–ä¸‹ä¸€é¦–ç´¢å¼•ï¼Œæ”¯æŒéšæœºæ’­æ”¾
  function getNextIndex() {
    if (isShuffle) {
      let nextIndex;
      do {
        nextIndex = Math.floor(Math.random() * modules[currentModule].length);
      } while (nextIndex === currentAudioIndex && modules[currentModule].length > 1);
      return nextIndex;
    } else {
      return (currentAudioIndex + 1) % modules[currentModule].length;
    }
  }

  // æ’­æ”¾æ§åˆ¶æŒ‰é’®äº‹ä»¶
  prevBtn.addEventListener('click', () => {
    if (currentAudioIndex === null) return;
    const prevIndex = (currentAudioIndex - 1 + modules[currentModule].length) % modules[currentModule].length;
    playAudio(prevIndex);
  });

  nextBtn.addEventListener('click', () => {
    if (currentAudioIndex === null) return;
    playAudio(getNextIndex());
  });

  playPauseBtn.addEventListener('click', () => {
    if (!audioPlayer.src) return;
    if (audioPlayer.paused) {
      audioPlayer.play();
    } else {
      audioPlayer.pause();
    }
    updatePlayPauseButton();
  });

  audioPlayer.addEventListener('play', updatePlayPauseButton);
  audioPlayer.addEventListener('pause', updatePlayPauseButton);

  audioPlayer.addEventListener('ended', () => {
    if (currentAudioIndex === null) return;
    playAudio(getNextIndex());
  });

  function updatePlayPauseButton() {
    playPauseBtn.textContent = audioPlayer.paused ? 'æ’­æ”¾' : 'æš‚åœ';
  }

  // Tabé”®ç›˜å¯¼èˆªåˆ‡æ¢æ¨¡å—
  tabs.forEach(tab => {
    tab.addEventListener('click', switchModule);
    tab.addEventListener('keydown', e => {
      const currentIndex = [...tabs].findIndex(t => t.getAttribute('aria-selected') === 'true');
      if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
        e.preventDefault();
        const nextIndex = (currentIndex + 1) % tabs.length;
        tabs[nextIndex].click();
      } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
        e.preventDefault();
        const prevIndex = (currentIndex - 1 + tabs.length) % tabs.length;
        tabs[prevIndex].click();
      }
    });
  });

  // é¡µé¢é¦–æ¬¡åŠ è½½æ—¶æ¸²æŸ“
  window.addEventListener('load', () => {
    renderAudioList();
    updateAriaControls();
  });
</script>
</body>
</html>
